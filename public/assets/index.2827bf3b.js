import{m,a as u}from"./Alert.429a8053.js";/* empty css             */import{S as p}from"./sweetalert2.all.5497c4f7.js";function f(e){return e.includes(".")?e:e.replace(/\B(?=(\d{3})+(?!\d))/g,".")}let d=null;const c={nombre:"",fecha:"",hora:"",servicios:[]};(function(e){e(document).ready(function(){function o(){e(window).width()>992?e(".navbar .dropdown").on("mouseover",function(){e(".dropdown-toggle",this).trigger("click")}).on("mouseout",function(){e(".dropdown-toggle",this).trigger("click").blur()}):e(".navbar .dropdown").off("mouseover").off("mouseout")}o(),e(window).resize(o)}),e(window).scroll(function(){e(this).scrollTop()>100?e(".back-to-top").fadeIn("slow"):e(".back-to-top").fadeOut("slow")}),e(".back-to-top").click(function(){return e("html, body").animate({scrollTop:0},1500,"easeInOutExpo"),!1}),e('[data-toggle="counter-up"]').counterUp({delay:10,time:2e3}),e(".service-carousel").owlCarousel({autoplay:!0,smartSpeed:1500,loop:!0,dots:!1,nav:!1,responsive:{0:{items:1},576:{items:2},768:{items:3},992:{items:4},1200:{items:5}}}),e(".pricing-carousel").owlCarousel({autoplay:!0,smartSpeed:1500,margin:30,loop:!0,dots:!1,nav:!1,responsive:{0:{items:1},576:{items:1},768:{items:2}}}),e(".testimonial-carousel").owlCarousel({autoplay:!0,smartSpeed:1500,margin:30,dots:!0,loop:!0,items:1})})(jQuery);document.addEventListener("DOMContentLoaded",function(){h()});function h(){w(),b(),y(),C(),k()}function v(e){e.forEach(o=>{const{id:t,nombre:r,precio:a}=o,n=document.createElement("P");n.classList.add("nombre-servicio"),n.textContent=r;const s=document.createElement("P");s.classList.add("precio-servicio"),s.textContent=`$${f(a)}`;const i=document.createElement("DIV");i.classList.add("servicio"),i.dataset.idServicio=t,i.onclick=function(){g(o)},i.appendChild(n),i.appendChild(s),document.querySelector("#servicios").appendChild(i)})}function g(e){const{id:o}=e,{servicios:t}=c,r=document.querySelector(`[data-id-servicio="${o}"]`);t.some(a=>a.id===o)?(c.servicios=t.filter(a=>a.id!==o),r.classList.remove("seleccionado")):(c.servicios=[...t,e],r.classList.add("seleccionado"))}function y(){document.querySelector("#fecha").addEventListener("input",function(o){const t=new Date(o.target.value).getUTCDay();[0].includes(t)?(o.target.value="",m("Los domingos no abrimos.","error",".formulario")):c.fecha=o.target.value})}function b(){document.querySelector("#hora").addEventListener("input",function(o){const t=o.target.value;let[r,a]=t.split(":");a="00",o.target.value=`${r}:${a}`,r<9||r>18?(o.target.value="",m("hora no valida, cerrado","error",".formulario")):c.hora=o.target.value})}async function w(){try{const o=await(await fetch(`${u}/servicios`)).json();v(o)}catch(e){console.log(e)}}async function S(){const e=document.querySelector("#nombre").value,o=document.querySelector("#apellido").value,t=document.querySelector("#telefono").value,r=document.querySelector("#email").value;if(c.nombre=e,e===""||o===""||t===""||r==="")return m("Todos los campos son obligatorios","error",".formulario");const a=new FormData;a.append("nombre",e),a.append("apellido",o),a.append("email",r),a.append("contrase\xF1a",t),a.append("telefono",t),a.append("admin",0),a.append("confirmado",0),a.append("token","");try{const s=await(await fetch(`${u}/usuarios`,{method:"POST",body:a})).json();return s.mensaje==="El usuario ya existe"?{id:s.usuario.id,name:`${s.usuario.nombre} ${s.usuario.apellido}`}:s.tipo==="error"?console.log("Error al creal el usuario"):(console.log("Usuario creado correctamente"),{id:s.usuario_id.id,name:`${e} ${o}`})}catch(n){console.log(n)}}async function C(){document.querySelector("#reservarCita").addEventListener("click",async e=>{e.preventDefault();const o=await S();d=o.id;const{fecha:t,hora:r,servicios:a}=c,n=a.map(i=>i.id),s=new FormData;s.append("fecha",t),s.append("hora",r),s.append("usuarioId",d),s.append("servicios",n.toString());try{const l=await(await fetch(`${u}/citas`,{method:"POST",body:s})).json();l.respuesta.tipo==="exito"?(await E(t,r,a,d),p.fire("Muy bien!",l.respuesta.mensaje,"success").then(()=>{window.location.href=`/pages/citas/citas.html?user=${d}&name=${o.name}`})):l.respuesta.mensaje==="Ya existe una cita programada para esa fecha y hora, porfavor seleccione otra fecha u hora."&&p.fire({icon:"error",title:"Lo sentimos!",text:l.respuesta.mensaje})}catch{p.fire({icon:"error",title:"Oops...",text:"Hubo un error al guardar la cita"})}})}async function E(e,o,t,r){try{const n=await(await fetch(`${u}/usuario/${r}`)).json();emailjs.send("service_g5hphjt","template_3i0zn3m",{to_name:n.nombre+" "+n.apellido,fecha:e,hora:o,servicios:t.map(s=>s.nombre).join(", "),from_name:n.nombre+" "+n.apellido,reply_to:n.email})}catch(a){console.log(a)}}async function k(){const e=new Headers;e.append("x-api-key","SmrpHhFDyszEDBHihC4ZKXgv0UKTI3ENmMdtfAwNVoQ="),e.append("x-secret","ff764d7066adf596297479b1d3e3e5e99eba1a60a7dc6659b030a22e40c22f69f6cc5f76bfbdeca0ce6b8d3233736dc74b1956d6de9f11827de5baeac9e2825c.8afaea0f168c4db7");const o={method:"GET",headers:e,redirect:"follow"};try{const r=await(await fetch("https://ms-public-api.rocketfy.com/rocketfy/api/v1/products?limit=4",o)).json();L(r)}catch(t){console.error(t)}}function L(e){const o=document.getElementById("productos-container");o.innerHTML="",e.forEach(t=>{const r=document.createElement("div");r.className="card",r.innerHTML=`
            <img src="${t.images[0].url}" alt="${t.name}">
            <div class="card-content">
                <h3 class="card-title">${t.name}</h3>
                <p class="card-price">$${t.dropshipper.price}</p>
                <a href="https://tatianaestetica.rocketfy.co/producto/${t.slug}" target="_blank" class="card-button">Comprar</a>
            </div>
        `,o.appendChild(r)})}
